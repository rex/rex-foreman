// Generated by CoffeeScript 1.6.3
(function() {
  var RexSocket, log;

  log = function() {
    return console.log.apply(console, arguments);
  };

  RexSocket = (function() {
    function RexSocket() {}

    RexSocket.prototype.init = function(SocketIOInstance) {
      this.io = SocketIOInstance;
      return this.connect();
    };

    RexSocket.prototype.connect = function() {
      this.socket = this.io.connect('http://localhost:3009');
      return this.setup();
    };

    RexSocket.prototype.setup = function() {
      return this.socket.on("config", function(config) {
        var $menu, template, tpl;
        log("Server sent config!", config);
        $menu = $(".menu");
        tpl = $("#process_item").html();
        template = Handlebars.compile(tpl);
        return _.each(config.procs, function(proc) {
          var parts, renderData;
          parts = proc.split(":");
          if (parts.length === 2) {
            renderData = {
              name: parts[0].trim(),
              command: parts[1].trim(),
              active: true
            };
            if (renderData.name.charAt(0) === "#") {
              renderData.name = (renderData.name.substr(1)).trim();
              renderData.active = false;
            }
            $menu.append(template(renderData));
          } else {
            renderData = {};
          }
          return log("Proc: ", renderData);
        });
      });
    };

    return RexSocket;

  })();

  window.RexSocket = new RexSocket;

}).call(this);
